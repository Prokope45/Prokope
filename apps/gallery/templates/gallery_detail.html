{% extends 'base.html' %}
{% load static %}

{% block extra_head_links %}
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/css/bootstrap-select.min.css">
  <link href="{% static 'lightbox/css/lightbox.css' %}" rel="stylesheet" />
  <link href="{% static 'css/gallery.css' %}" rel="stylesheet" />
{% endblock %}

{% block gallery %}
  <head>
    <title>Gallery Detail</title>
  </head>
  <body>
    {% include 'navbar.html' %}
    <div id='content' class="mt-4">
      <section class="portfolio" id="portfolio">
        <div class="container">
          <div class="d-flex align-items-center mb-3" style="min-height: 42px;">
            <div class="me-auto" style="width: 145px;">
              <button
                class="post-back-button btn btn-outline-secondary btn-sm w-100"
                onclick="location.href='/gallery';"
              >
                <span>Back to Gallery</span>
              </button>
            </div>
            <div class="flex-grow-1 text-center">
              <!-- TODO: Add specific style for title to share purple color -->
              <h1 class="mb-0 card-title">{{ object.country }}</h1>  
            </div>
          </div>
          <div class="d-flex justify-content-end">
            <div class="form-group">
              <form method="get" action="{% url 'gallery_detail' object.slug %}">
                <select id="city-filter" class="selectpicker" name="city">
                  <option disabled style="color: #6c757d;">Filter by city</option>
                  <option value="all" {% if selected_city == 'all' %}selected{% endif %}>All</option>
                  {% for city in cities %}
                    <option value="{{ city }}" {% if selected_city == city %}selected{% endif %}>{{ city }}</option>
                  {% endfor %}
                </select>
              </form>
            </div>
          </div>
          <div id="masonry-container">
            <div class="row">
              {% for gallery in city_galleries %}
                {% for photo in gallery.photos.all %}
                  <div
                    class="gallery_product p-0 col-lg-4 col-md-4 col-sm-6 col-xs-12 filter {{ photo.city.name }}"
                  >
                    <a
                      title="{{ photo.title }} on {{ photo.date_taken }}"
                      href="{{ photo.get_display_url }}"
                      data-lightbox="{{ gallery }}"
                      class="m-2 d-block"
                    >
                      <img
                        class="travel-photo d-block"
                        src="{{ photo.get_display_url }}"
                        alt="{{ photo.title }}: {{ photo.caption }}"
                        loading="lazy"
                      >
                    </a>
                  </div>
                {% endfor %}
              {% endfor %}
            </div>
          </div>
        </div>
      </section>
    </div>
    {% include 'footer.html' %}
  </body>
{% endblock gallery %}

{% block extra_script_links %}
  <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/js/bootstrap-select.min.js"></script>
  <script src="{% static 'lightbox/js/lightbox-plus-jquery.js' %}"></script>
  <script src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
  <script src="https://unpkg.com/imagesloaded@5/imagesloaded.pkgd.min.js"></script>
  <script src="{% static 'js/gallery_detail.js' %}"></script>
{% endblock %}
